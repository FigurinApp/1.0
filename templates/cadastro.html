@app.route("/cadastro", methods=["GET", "POST"])
def cadastro():
    if request.method == "POST":
        nome = request.form["nome"]
        email = request.form["email"]
        senha = request.form["senha"]

        usuario_existente = User.query.filter_by(email=email).first()
        if usuario_existente:
            flash("E-mail já cadastrado. Tente outro.")
            return redirect(url_for("cadastro"))

        senha_criptografada = generate_password_hash(senha)
        novo_usuario = User(nome=nome, email=email, senha=senha_criptografada)
        db.session.add(novo_usuario)
        db.session.commit()

        flash("Usuário cadastrado com sucesso!")
        return redirect(url_for("index"))

    return render_template("cadastro.html")
